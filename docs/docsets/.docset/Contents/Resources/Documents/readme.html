<!DOCTYPE html>
<html lang="en">
  <head>
    <title>README  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset="utf-8">
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
    <script src="js/lunr.min.js" defer></script>
    <script src="js/typeahead.jquery.js" defer></script>
    <script src="js/jazzy.search.js" defer></script>
  </head>
  <body>


    <a title="README  Reference"></a>

    <header class="header">
      <p class="header-col header-col--primary">
        <a class="header-link" href="index.html">
           Docs
        </a>
         (36% documented)
      </p>
    
      <p class="header-col--secondary">
        <form role="search" action="search.json">
          <input type="text" placeholder="Search documentation" data-typeahead>
        </form>
      </p>
    
    
    </header>

    <p class="breadcrumbs">
      <a class="breadcrumb" href="index.html"> Reference</a>
      <img class="carat" src="img/carat.png" />
      README  Reference
    </p>

    <div class="content-wrapper">
      <nav class="navigation">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Guides.html">Guides</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="readme.html">README</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/AnalyticsService.html">AnalyticsService</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/AnalyticsService/NetworkEnvironment.html">– NetworkEnvironment</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/AppDetailServerData.html">AppDetailServerData</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/AppServerData.html">AppServerData</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/CoreDataCrashEvent.html">CoreDataCrashEvent</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/CoreDataLocalEvent.html">CoreDataLocalEvent</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/CoreDataManager.html">CoreDataManager</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/CrashModel.html">CrashModel</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/CrashModel/CrashType.html">– CrashType</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/CrashService.html">CrashService</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/DeviceDetailServerData.html">DeviceDetailServerData</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/DeviceServerData.html">DeviceServerData</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/ServerDispatchServices.html">ServerDispatchServices</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/TokenBucket.html">TokenBucket</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/VaporNetworkService.html">VaporNetworkService</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Enums.html">Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/AnalyticEvent.html">AnalyticEvent</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/PrivateAnalyticEvent.html">PrivateAnalyticEvent</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Extensions.html">Extensions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/Thread.html">Thread</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Protocols.html">Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/AnalyticEventProtocol.html">AnalyticEventProtocol</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/AppQueryableProtocol.html">AppQueryableProtocol</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/IDFVQueryableProtocol.html">IDFVQueryableProtocol</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols.html#/s:12AppAnalytics16PageableProtocolP">PageableProtocol</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/VaporModel.html">VaporModel</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Structs.html">Structures</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/AnalyticsServiceConfiguration.html">AnalyticsServiceConfiguration</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/AnalyticsServiceConfiguration/Environment.html">– Environment</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/AppInfoModel.html">AppInfoModel</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/AppServerViewModel.html">AppServerViewModel</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/CrashServerViewModel.html">CrashServerViewModel</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/CrashServerViewModel/CallStackRecord.html">– CallStackRecord</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/DevCrashEventDetailView.html">DevCrashEventDetailView</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/DevLocalEventDetailView.html">DevLocalEventDetailView</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/DeviceServerViewModel.html">DeviceServerViewModel</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/EventServerViewModel.html">EventServerViewModel</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/LocalDeviceAnalyticsView.html">LocalDeviceAnalyticsView</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/LocalDeviceAnalyticsView_Previews.html">LocalDeviceAnalyticsView_Previews</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/LocalDeviceCrashsView.html">LocalDeviceCrashsView</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/LocalDeviceCrashsView_Previews.html">LocalDeviceCrashsView_Previews</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/LocalDeviceInfoModel.html">LocalDeviceInfoModel</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/ServerAppDetailView.html">ServerAppDetailView</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/ServerAppDetailView_Previews.html">ServerAppDetailView_Previews</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/ServerAppsView.html">ServerAppsView</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/ServerAppsView_Previews.html">ServerAppsView_Previews</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/ServerCrashDetailView.html">ServerCrashDetailView</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/ServerDeviceDetailView.html">ServerDeviceDetailView</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/ServerDeviceDetailView_Previews.html">ServerDeviceDetailView_Previews</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/ServerDevicesView.html">ServerDevicesView</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/ServerDevicesView_Previews.html">ServerDevicesView_Previews</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/ServerEventDetailView.html">ServerEventDetailView</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/VaporAnalyticEventModel.html">VaporAnalyticEventModel</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/VaporAnalyticEventModel/CodingKeys.html">– CodingKeys</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/VaporAppInfoModel.html">VaporAppInfoModel</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/VaporAppInfoModel/CodingKeys.html">– CodingKeys</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/VaporCrashEventModel.html">VaporCrashEventModel</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/VaporCrashEventModel/CodingKeys.html">– CodingKeys</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/VaporDeviceModel.html">VaporDeviceModel</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/VaporDeviceModel/CodingKeys.html">– CodingKeys</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/VaporUserModel.html">VaporUserModel</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/VaporUserModel/CodingKeys.html">– CodingKeys</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Typealiases.html">Type Aliases</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Typealiases.html#/s:12AppAnalytics7VaporIDa">VaporID</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">

        <section class="section">
          <div class="section-content top-matter">
            
            <h2 id='appanalytics-ios' class='heading'>appAnalytics-iOS</h2>

<p>Framework for self hosted iOS application analytics and simple crash reporting </p>

<p>Companion server can be found at: <a href="https://github.com/mschmulen/appAnalyticsServer">https://github.com/mschmulen/appAnalyticsServer</a> </p>
<h2 id='getting-started' class='heading'>Getting started</h2>

<ol>
<li><code>git clone git@github.com:mschmulen/appAnalytics-iOS.git</code></li>
<li><code>cd appAnalytics-iOS</code></li>
<li><code>open AppAnalytics.xcodeproj/</code></li>
<li>run or deploy companion server</li>
<li>run the sample app</li>
</ol>
<h2 id='sample-swiftui-app-with-localhosst-server' class='heading'>Sample SwiftUI App with localhosst server</h2>

<p>Demo and test app for testing swift analytics, configured to use <code>localhost</code> make sure and run the Companion server can be found at: </p>

<ol>
<li>Start the local companion server:  <a href="https://github.com/mschmulen/appAnalyticsServer">https://github.com/mschmulen/appAnalyticsServer</a></li>
<li>Select the <code>AnalyticsSwiftUIExample</code> build target</li>
<li>Compile and run in the local simuation</li>
</ol>
<h2 id='overview' class='heading'>Overview</h2>

<p>The framework SDK leverages a local CoreData (sqlite) data store to hold analytics allowing for offline caching of events and bursts the analytics events to the server using a TokenBucket to throttle burst size and network consumption.  The basic <code><a href="Enums/AnalyticEvent.html">AnalyticEvent</a></code> <code>AnalyticEvent.viewDidAppear</code> or <code>AnalyticEvent.customEvent</code> can be used directly or the Application can create custom events by conforming to the <code><a href="Protocols/AnalyticEventProtocol.html">AnalyticEventProtocol</a></code> protocol.  Additionally the framework can be configured to also catch, cache and upload <code>CrashEvents</code> with stack trace information for crash signals and uncaught swift exceptions.  The framework leverages a local UUID for each crash event to prevent duplicate events from being entered into the Analytics server side data store and also to insure that events are not removed from the local device storage until a server confirmation is recieved by the client.</p>

<p>If the host application integrates the appropriate <code>applicationDidBecomeActive</code>, <code>applicationWillResignActive</code>, etc. The service will automatically report lifecycle events</p>
<pre class="highlight plaintext"><code>didFinishLaunchingWithOptions
applicationDidBecomeActive
applicationWillResignActive
applicationDidEnterBackground
applicationWillEnterForeground
applicationWillTerminate
applicationDidReceiveMemoryWarning
</code></pre>
<h2 id='documentation-notes' class='heading'>Documentation Notes</h2>

<p>install jazzy with:</p>

<p><code>[sudo] gem install jazzy</code></p>

<p>update <code>docs</code> with:</p>

<p><code>jazzy --min-acl internal --no-hide-documentation-coverage --theme fullwidth --output ./docs --documentation=./*.md</code></p>
<h2 id='usage' class='heading'>Usage</h2>

<p>In the AppDelegate <code>didFinishLaunchingWithOptions</code> initialize the AnalyticsService</p>
<pre class="highlight plaintext"><code>
let analyticsServiceConfig = AnalyticsServiceConfiguration.defaultLocalConfiguration

AnalyticsService.start(config: analyticsServiceConfig)

_ = AnalyticsService.shared().application(application, didFinishLaunchingWithOptions: launchOptions)

</code></pre>

<p>Dispatch an event:</p>
<pre class="highlight plaintext"><code>AnalyticsService.dispatchAnalyticEvent(.viewDidAppear(viewName: "HomeView"))
</code></pre>
<h2 id='note-about-the-tokenbucket' class='heading'>Note about the TokenBucket</h2>

<p>A Token bucket is a simple algorithm used for rate-limiting events and shaping network traffic</p>

<p>Notes:
 The benefit of using a TokenBucket is that it does not require any system level timers to manage the dispatching of events to the network. When the system wants to send an event it first checks the token bucket to see if it has enough tokens to to do this. If not then then the event must wait for the buck to be refreshed the token refresh is determined by the <code>tokensPerInterval</code> and the <code>interval</code>. the tokenBucket is checked for potential refresh every time the system requests a <code>tokenCount</code>.</p>

<p>For the Analytics usage the <code>tokenCount</code> is checked everytime an event is posted to the local storage via the <code>dispatchAnalyticEvent</code> call. Every <code>dispatchAnalyticEvent</code> will trigger a <code>flush</code> request that will request events oldest first and dispatch them to the network as the accumulated tokens permit, in this way events are dispatched FIFO style and will not overwhelm the network with a large body of network requests.</p>

<p>References:</p>

<ul>
<li><a href="https://en.wikipedia.org/wiki/Token_bucket">https://en.wikipedia.org/wiki/Token_bucket</a></li>
<li><a href="https://pfandrade.me/blog/rate-limiting-using-a-token-bucket-in-swift/">https://pfandrade.me/blog/rate-limiting-using-a-token-bucket-in-swift/</a></li>
<li><a href="https://github.com/pfandrade/TokenBucket">https://github.com/pfandrade/TokenBucket</a></li>
<li><p><a href="https://github.com/nuclearace/SwiftRateLimiter">https://github.com/nuclearace/SwiftRateLimiter</a></p></li>
<li><p><a href="https://www.juniper.net/documentation/en_US/junos/topics/concept/policer-algorithm-single-token-bucket.html">https://www.juniper.net/documentation/en_US/junos/topics/concept/policer-algorithm-single-token-bucket.html</a></p></li>
<li><p><a href="https://dzone.com/articles/detailed-explanation-of-guava-ratelimiters-throttl">https://dzone.com/articles/detailed-explanation-of-guava-ratelimiters-throttl</a></p></li>
</ul>

          </div>
        </section>


      </article>
    </div>
    <section class="footer">
      <p>&copy; 2020 <a class="link" href="" target="_blank" rel="external"></a>. All rights reserved. (Last updated: 2020-01-06)</p>
      <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.13.0</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external">Realm</a> project.</p>
    </section>
  </body>
</div>
</html>
